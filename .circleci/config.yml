version: 2.0
jobs:
  build:
    docker:
      - image: wodby/drupal-php:7.4-4.17.1
      - image: wodby/mariadb:10.4-3.8.5
        environment:
          MYSQL_ROOT_PASSWORD: lilengine
          MYSQL_DATABASE: default
          MYSQL_USER: user
          MYSQL_PASSWORD: user
      - image: wodby/nginx:1.19-5.10.2
    steps:
      - checkout
          path: /var/www/html
      - run: $PWD
      # Setup Environment Variables
      - run:
          name: Setup Environment Variables
          command: |
            echo "export PATH=$PATH:$HOME/project/vendor/bin" >> $BASH_ENV
      - run: composer install
      - run: phpcs web/core/modules/action
